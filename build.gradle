
buildscript {
  repositories {
    jcenter()
  }
  dependencies {
    classpath "org.springframework.boot:spring-boot-gradle-plugin:2.1.4.RELEASE"
  }
}

plugins {
  id "io.freefair.lombok" version "3.2.1" apply false
  id "io.spring.dependency-management" version "1.0.8.RELEASE"
}

def versions = [
  jackson: "2.9.8",
  javaxPersistence: "2.2",
  javaxValidation: "2.0.1.Final",
  mockito: "2.20.1",
  mysqlConnector: "8.0.16",
  springDataJpa: "2.1.7.RELEASE",
  springFramework: "5.1.6.RELEASE",
  springKafka: "2.2.6.RELEASE",
  springfoxSwagger2: "2.9.2",
  springfoxSwaggerUi: "2.9.2",
  springCloud: "Greenwich.SR2"
]

allprojects {

  apply plugin: "java"
  apply plugin: "org.springframework.boot"
  apply plugin: "io.spring.dependency-management"
  apply plugin: "io.freefair.lombok"

  configurations {
    developmentOnly
    runtimeClasspath {
      extendsFrom developmentOnly
    }
  }

  dependencyManagement {
    imports {
      mavenBom "org.junit:junit-bom:5.5.1"
      mavenBom "org.springframework.boot:spring-boot-dependencies:$versions.springBoot"
      mavenBom "org.springframework.cloud:spring-cloud-dependencies:$versions.springCloud"
    }
  }

  version "1.0.0-SNAPSHOT"
  group "cc.vivp.bankrupt"

  sourceCompatibility = 1.8
  targetCompatibility = 1.8

  repositories {
    jcenter()
  }
}

project(":service-payment-producer") {

  bootJar {
    baseName = "service-payment-producer"
    version =  "1.0.0-SNAPSHOT"
  }

  dependencies {
    implementation project(":domain-models")
    implementation project(":component-data-repositories")
    implementation "org.springframework.boot:spring-boot-starter-web"
    implementation "org.springframework.boot:spring-boot-starter-data-jpa"
    implementation "org.springframework.kafka:spring-kafka:$versions.springKafka"
    implementation "io.springfox:springfox-swagger2:$versions.springfoxSwagger2"
    implementation "io.springfox:springfox-swagger-ui:$versions.springfoxSwaggerUi"
    implementation "org.springframework.cloud:spring-cloud-starter-netflix-eureka-client"
    developmentOnly "org.springframework.boot:spring-boot-devtools"
    runtime "mysql:mysql-connector-java:$versions.mysqlConnector"
    testImplementation "org.springframework.boot:spring-boot-starter-test"
    testImplementation "org.junit.jupiter:junit-jupiter-api"
    testImplementation "org.mockito:mockito-junit-jupiter:$versions.mockito"
    testRuntime "org.junit.jupiter:junit-jupiter-engine"
  }

  test {
    useJUnitPlatform()
  }

}

project(":worker-payment-consumer") {

  bootJar {
    baseName = "worker-payment-consumer"
    version =  "0.0.1-SNAPSHOT"
  }

  dependencies {
    implementation project(":domain-models")
    implementation project(":component-data-repositories")
    implementation "org.springframework.boot:spring-boot-starter-web"
    implementation "org.springframework.boot:spring-boot-starter-data-jpa"
    implementation "org.springframework.kafka:spring-kafka:$versions.springKafka"
    implementation "org.springframework.cloud:spring-cloud-starter-netflix-eureka-client"
    developmentOnly "org.springframework.boot:spring-boot-devtools"
    runtime "mysql:mysql-connector-java:$versions.mysqlConnector"
    testImplementation "org.springframework.boot:spring-boot-starter-test"
    testImplementation "org.junit.jupiter:junit-jupiter-api"
    testImplementation "org.mockito:mockito-junit-jupiter:$versions.mockito"
    testRuntime "org.junit.jupiter:junit-jupiter-engine"
  }

  test {
    useJUnitPlatform()
  }

}

project(":component-data-repositories") {

  dependencies {
  	implementation project(":domain-models")
    implementation "org.springframework.data:spring-data-jpa:$versions.springDataJpa"
  }
}

project(":domain-models") {

  dependencies {
    implementation "javax.validation:validation-api:$versions.javaxValidation"
    implementation "org.springframework:spring-web:$versions.springFramework"
    implementation "com.fasterxml.jackson.datatype:jackson-datatype-jsr310:$versions.jackson"
    implementation "javax.persistence:javax.persistence-api:$versions.javaxPersistence"
  }
}

project(":naming-server") {

  bootJar {
    baseName = "naming-server"
    version =  "0.0.1-SNAPSHOT"
  }

  dependencies {
    implementation "org.springframework.boot:spring-boot-starter-actuator"
    implementation "org.springframework.cloud:spring-cloud-starter-config"
    implementation "org.springframework.cloud:spring-cloud-starter-netflix-eureka-server"
    developmentOnly "org.springframework.boot:spring-boot-devtools"
  }
}

project(":api-gateway") {

  bootJar {
    baseName = "api-gateway"
    version =  "0.0.1-SNAPSHOT"
  }

  dependencies {
    implementation "org.springframework.cloud:spring-cloud-starter-netflix-zuul"
    implementation "org.springframework.boot:spring-boot-starter-actuator"
    implementation "org.springframework.cloud:spring-cloud-starter-config"
    implementation "org.springframework.cloud:spring-cloud-starter-netflix-eureka-server"
    developmentOnly "org.springframework.boot:spring-boot-devtools"
  }
}

project(":service-transaction-management") {

  bootJar {
    baseName = "service-transaction-management"
    version =  "1.0.0-SNAPSHOT"
  }

  dependencies {
    implementation project(":domain-models")
    implementation project(":component-data-repositories")
    implementation "org.springframework.boot:spring-boot-starter-web"
    implementation "org.springframework.boot:spring-boot-starter-data-jpa"
    implementation "io.springfox:springfox-swagger2:$versions.springfoxSwagger2"
    implementation "io.springfox:springfox-swagger-ui:$versions.springfoxSwaggerUi"
    implementation "org.springframework.cloud:spring-cloud-starter-netflix-eureka-client"
    developmentOnly "org.springframework.boot:spring-boot-devtools"
    runtime "mysql:mysql-connector-java:$versions.mysqlConnector"
    testImplementation "org.springframework.boot:spring-boot-starter-test"
    testImplementation "org.junit.jupiter:junit-jupiter-api"
    testImplementation "org.mockito:mockito-junit-jupiter:$versions.mockito"
    testRuntime "org.junit.jupiter:junit-jupiter-engine"
  }

  test {
    useJUnitPlatform()
  }

}
